<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mini IA Online (Sin API)</title>

<!-- IA desde CDN: no requiere servidor, CPU ni API -->
<script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0/dist/transformers.min.js"></script>

<style>
    body {
        margin:0;
        background:#0e1320;
        color:white;
        font-family:Arial;
        display:flex;
        flex-direction:column;
        align-items:center;
        padding:20px;
    }
    #container {
        width:90%;
        max-width:700px;
    }
    h1 {
        text-align:center;
        margin-bottom:20px;
    }
    #chat {
        background:#141b2e;
        border-radius:12px;
        padding:20px;
        height:400px;
        overflow-y:auto;
        border:1px solid #25345c;
    }
    .msg-user {
        color:#62e0ff;
        margin:10px 0;
    }
    .msg-ai {
        color:#90ffa2;
        margin:10px 0;
    }
    #input-area {
        margin-top:15px;
        display:flex;
        gap:10px;
    }
    input {
        flex:1;
        padding:12px;
        border-radius:8px;
        border:none;
        font-size:16px;
    }
    button {
        padding:12px 18px;
        border:none;
        border-radius:8px;
        background:#3f63ff;
        color:white;
        cursor:pointer;
        font-size:16px;
    }
    button:hover {
        background:#657dff;
    }
</style>

</head>
<body>

<div id="container">
    <h1>ðŸ¤– Mini IA Online (Sin API)</h1>

    <div id="chat"></div>

    <div id="input-area">
        <input id="prompt" placeholder="Escribe algo...">
        <button onclick="send()">Enviar</button>
    </div>
</div>

<script>
let generator;
const chat = document.getElementById("chat");

// Mensajes en pantalla
function addAI(text) {
    chat.innerHTML += `<div class='msg-ai'><b>IA:</b> ${text}</div>`;
    chat.scrollTop = chat.scrollHeight;
}
function addUser(text) {
    chat.innerHTML += `<div class='msg-user'><b>TÃº:</b> ${text}</div>`;
    chat.scrollTop = chat.scrollHeight;
}

// Cargar modelo IA (tarda 3â€“7 seg en mÃ³viles)
(async () => {
    addAI("Cargando IA... espera unos segundos.");
    
    generator = await window.transformers.pipeline(
        "text-generation",
        "Xenova/phi2"  // IA pequeÃ±a, inteligente y GRATIS
    );

    addAI("Â¡Listo! Ya puedes hablar conmigo ðŸ˜„");
})();

// Enviar mensaje
async function send() {
    const input = document.getElementById("prompt");
    const text = input.value.trim();
    if (!text) return;

    addUser(text);
    input.value = "";

    addAI("Pensando...");

    const out = await generator(text, {
        max_new_tokens: 70,
        temperature: 0.8,
        top_p: 0.9
    });

    let response = out[0].generated_text.replace(text, "").trim();

    // Reemplaza mensaje


